parameters:
- name: BuildConfiguration
  type: string
  default: 'Dev'
- name: IacScriptPath
  type: string

jobs:
- deployment: Deploy
  displayName: 'Deploy'
  environment: '${{ parameters.BuildConfiguration }}'
  strategy:
    runOnce:
      deploy:
        steps:
        - checkout: none
                  
        - task: Bash@3
          displayName: 'Make IaC script executable'
          inputs:
            targetType: 'inline'
            script: |
              chmod +x ${{ parameters.IacScriptPath }}

        - task: Bash@3
          displayName: 'Execute IaC script'
          inputs:
            targetType: 'inline'
            script: |
              .${{ parameters.IacScriptPath }}
          
        # - task: AzureWebApp@1
        #   inputs:
        #     azureSubscription: 'ADJHL-DEV(62357630-10db-456c-81c4-985bbe4653b1)'
        #     appType: 'webAppLinux'
        #     appName: 'ArtStore'
        #     package: '$(Pipeline.Workspace)/$(Build.ArtifactStagingDirectory)/$(Build.BuildId).zip'
        #     runtimeStack: 'NODE|18-lts'
        #     startUpCommand: 'dotnet ArtStore.dll'
        #   displayName: 'Deploy to Azure App Service'
